CREATE TABLE T_ROLE (
ID int PRIMARY KEY NOT NULL,
NAME VARCHAR(25) NOT NULL);

CREATE TABLE T_USER (
ID int PRIMARY KEY NOT NULL, 
FIRSTNAME varchar(25) NOT NULL,
SURNAME varchar(25) NOT NULL,
PHONE varchar(12),
ROLE_ID int REFERENCES T_ROLE(ID));

CREATE TABLE T_USER_ACCOUNT (
ID int PRIMARY KEY NOT NULL, 
LOGIN VARCHAR(25) NOT NULL,
PASSWORD VARCHAR(25) NOT NULL,
USER_ID int REFERENCES T_USER(ID));

create table T_USER_GROUP ( 
USER_ID int REFERENCES T_USER(ID),
GROUP_ID int REFERENCES T_GROUP(ID),
CONSTRAINT USER_GROUP_ID PRIMARY KEY (USER_ID, GROUP_ID));

create table T_GROUP (
ID int PRIMARY KEY NOT NULL,
NAME varchar(25));

CREATE TABLE T_RESOURCE (
ID int PRIMARY KEY NOT NULL,
RESOURCE_DATA bytea,
NOTE_TYPE varchar(10));

CREATE TABLE T_NOTE (
ID int PRIMARY KEY NOT NULL,
ACTION_ID int REFERENCES T_ACTION(ID),
USER_ID int REFERENCES T_USER(ID),
DATE_TIME timestamp,
TEXT varchar(100),
RESOURCE_ID int REFERENCES T_RESOURCE);

CREATE TABLE T_ACTION (
ID int PRIMARY KEY NOT NULL,
NAME varchar(100) NOT NULL,
START_DATE timestamp NOT NULL,
END_DATE timestamp,
GROUP_ID int REFERENCES T_GROUP(ID));

CREATE TABLE T_POSITION (
ID int PRIMARY KEY NOT NULL,
ACTION_ID int REFERENCES T_ACTION(ID),
USER_ID int REFERENCES T_USER(ID),
LATITUDE float NOT NULL,
LONGITUDE float NOT NULL, 
DATE_TIME timestamp NOT NULL);
 
CREATE TABLE T_PHOTO (
ID int PRIMARY KEY NOT NULL,
PHOTO_DATA bytea NOT NULL,
DATE_TIME timestamp NOT NULL);

CREATE TABLE T_MESSAGE_DETAILS (
ID int PRIMARY KEY NOT NULL,
DATE_TIME timestamp NOT NULL,
TEXT VARCHAR(250),
FROM_USER_ID int REFERENCES T_USER(ID),
PHOTO_ID int REFERENCES T_PHOTO(ID));

CREATE TABLE T_MESSAGE_TO_USER (
TO_USER_ID int REFERENCES T_USER(ID),
MESSAGE_DETAILS_ID int REFERENCES T_MESSAGE_DETAILS(ID),
CONSTRAINT MESSAGE_TO_USER_ID PRIMARY KEY (MESSAGE_DETAILS_ID, TO_USER_ID));

CREATE TABLE T_LAYER (
ID int PRIMARY KEY NOT NULL,
FILENAME varchar(25),
LAYER_DATA bytea NOT NULL,
ACTION_ID int REFERENCES T_ACTION(ID)
)